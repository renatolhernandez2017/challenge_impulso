<div class="main">
  <nav class="sidebar d-flex flex-column">
    <h4 class="text-white text-center my-4">Usuário</h4>

    <div class="d-flex align-items-center justify-content-center">
      <span class="me-1 text-white"><%= current_user.email %></span>
    </div>

    <div class="d-flex align-items-center justify-content-center my-3">
      <%= link_to destroy_user_session_path, class: "btn btn-danger btn-sm",
          data: { turbo_method: :delete }, title: "Sair" do %>
        Sair
      <% end %>
    </div>
  </nav>

  <div class="content">
    <div class="row g-4">
      <div class="col-12 d-flex gap-4">
        <div class="card border-0 shadow-lg flex-fill">
          <div class="card-body">
            <h5 class="card-title">Proponentes</h5>
            <p class="card-text fs-4">120</p>
          </div>
        </div>

        <div class="card border-0 shadow-lg flex-fill">
          <div class="card-body">
            <h5 class="card-title">Salários Registrados</h5>
            <p class="card-text fs-4">R$ 256.000</p>
          </div>
        </div>

        <div class="card border-0 shadow-lg flex-fill">
          <div class="card-body">
            <h5 class="card-title">Descontos INSS</h5>
            <p class="card-text fs-4">R$ 45.820</p>
          </div>
        </div>
      </div>

      <div class="row d-flex flex-column my-5">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Documento</th>
              <th>Data de Nascimento</th>
              <th>Salário</th>
              <th>Desconto INSS</th>
              <th>Contatos</th>
            </tr>
          </thead>

          <tbody>
            <% @proponents.each_with_index do |proponent, index| %>
              <tr>
                <td><%= proponent.name %></td>
                <td><%= proponent.document %></td>
                <td><%= proponent.birth_date %></td>
                <td><%= proponent.salary %></td>
                <td><%= proponent.inss_discount %></td>

                <td data-controller="toggle" data-action="click->toggle#toggleRow" data-tr-id="tr_hidden_<%= index %>">
                  <details>
                    <summary class="collapse-title font-semibold d-inline-block d-flex">
                      Expandir
                      <span class="material-symbols-outlined">keyboard_arrow_down</span>
                    </summary>
                  </details>
                </td>
              </tr>

              <tr class="d-none" id="tr_hidden_<%= index %>">
                <td colspan="8">
                  <table class="table table-striped">
                    <thead class="text-base">
                      <tr>
                        <th>Contatos</th>
                        <th>Endereços</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>
                          <% proponent.contacts.each do |contact| %>
                            <div>
                              <strong><%= contact.contact_type %>:</strong> <%= contact.value %>
                            </div>
                          <% end %>
                        </td>

                        <td>
                          <% proponent.addresses.each do |address| %>
                            <div>
                              <%= address.street %>, <%= address.number %> - <%= address.neighborhood %> -
                              <%= address.city %> - <%= address.state %> - CEP: <%= address.zip_code %>
                            </div>
                          <% end %>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        Gráfico
      </div>
    </div>
  </div>
</div>
